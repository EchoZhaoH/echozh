{"version":3,"sources":["components/webgl/class1/demo1/shader.vert","components/webgl/class1/demo1/shader.frag","components/webgl/class1/demo2/shader.vert","components/webgl/class1/demo2/shader.frag","components/webgl/class1/demo3/shader.vert","components/webgl/class1/demo3/shader.frag","components/webgl/class1/demo4/shader.vert","components/webgl/class1/demo4/shader.frag","assets/svg/github.svg","data/index.ts","components/header/index.tsx","hooks/usePat.ts","components/pet/index.tsx","components/entry/index.tsx","App.tsx","hooks/useWebGL.ts","hooks/useFetch.ts","api/index.ts","components/back/index.tsx","components/archive/item.tsx","components/archive/index.tsx","components/article/index.tsx","components/graffiti/canvas/types.ts","components/graffiti/canvas/shaps.ts","components/graffiti/canvas/transformer.ts","components/graffiti/canvas/line.ts","components/graffiti/canvas/emmiter.ts","components/graffiti/canvas/index.ts","components/graffiti/components/toolbar/header.tsx","components/popover/index.tsx","components/graffiti/components/toolbar/action.tsx","components/graffiti/index.tsx","assets/images/stage-1.jpeg","components/v-world/index.tsx","common/mv.js","common/shader.ts","components/webgl/class1/demo1/index.tsx","components/webgl/class1/demo2/index.tsx","components/webgl/class1/demo3/index.tsx","components/webgl/class1/demo4/index.tsx","data/webgl-class.ts","hooks/useModeSwitch.ts","components/webgl/classes/index.tsx","route.tsx","index.tsx"],"names":["module","exports","_path","_excluded","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgGithub","_ref","svgRef","title","titleId","props","xmlns","className","width","height","preserveAspectRatio","viewBox","style","verticalAlign","ref","id","d","fill","ForwardRef","activeDepot","url","Header","to","href","Application","registerPlugin","TickerPlugin","Live2DModel","registerTicker","Ticker","Renderer","InteractionManager","deafaultUrl","Pet","useRef","cns","classNames","options","modelUrl","onLoad","rest","useEffect","a","app","view","current","from","live2dSprite","scale","set","position","stage","addChild","init","useLiveWidget","backgroundColor","Entry","as","cursor","map","App","useWebGL","useState","gl","setGl","canvas","getContext","viewport","clearColor","useGet","initData","opts","loading","setLoading","data","setData","input","option","fetch","then","res","status","ok","json","Error","catch","e","console","log","message","finally","fetching","Back","ArticleItem","date","tag","body","Archive","Article","dangerouslySetInnerHTML","__html","ActionType","GraffitiShape","GraffitiTransformer","renderer","transformer","selectionRectangle","transformerID","selectionRectangleID","rect","uuid","x1","y1","x2","y2","Konva","Transformer","borderDash","borderStroke","anchorFill","Rect","visible","addShape","initListeners","on","action","NONE","nodeType","metaPressed","evt","shiftKey","ctrlKey","metaKey","isSelected","nodes","slice","splice","concat","preventDefault","getPointerPosition","x","y","setAttrs","Math","min","abs","setTimeout","shapes","find","box","getClientRect","selected","filter","shape","shapeID","Util","haveIntersection","off","GraffitiLine","lines","painting","initStageListeners","initRendererEvents","isPenAction","line","Line","stroke","strokeWidth","push","point","points","PEN","Emitter","listeners","fn","p","listener","forEach","Stage","Layer","GraffitiBoard","container","config","layers","activeLayer","add","setCursor","initShapes","autoResize","emit","destroy","window","addEventListener","innerWidth","innerHeight","HeaderToolbar","Popover","children","content","triggerRef","tooltipRef","popperInstance","show","useCallback","setAttribute","setOptions","modifiers","name","enabled","update","hidden","removeAttribute","trigger","tooltip","createPopper","placement","showEvents","hideEvents","event","removeEventListener","role","ActionToolbar","onAction","onClick","Graffiti","setAction","refEl","VWorld","el","scene","THREE","camera","setSize","appendChild","domElement","geometry","material","load","bgImg","cube","bgTexture","mapping","wrapS","wrapT","repeat","background","z","timer","animate","requestAnimationFrame","rotation","render","cancelAnimationFrame","_argumentsToArray","args","vec2","result","vec3","vec4","mat2","v","m","matrix","mat3","mat4","u","j","transpose","mix","s","Array","isArray","flatten","n","elemsAreArrays","floats","Float32Array","idx","byteLength","createShader","type","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","createProgram","shaders","program","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","Sierpinski","pointsCount","pow","numTimesDivide","vertices","divideTriangle","b","c","count","triangle","ab","ac","bc","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","vertex","VERTEX_SHADER","frag","FRAGMENT_SHADER","useProgram","vPosition","getAttribLocation","FLOAT","vertexAttribPointer","enableVertexAttribArray","loaderProgram","clear","COLOR_BUFFER_BIT","drawArrays","TRIANGLES","floor","random","POINTS","colors","color","baseColor","tetra","ad","bd","cd","enable","DEPTH_TEST","cBuffer","vColor","DEPTH_BUFFER_BIT","Mode","WEBGLClasses","path","WEBGLClassesPage","cls","RoutesMap","matchMedia","matches","document","documentElement","classList","exact","component","Class1Demo4","Class1Demo3","Class1Demo2","Class1Demo1","match","params","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.233540a3.chunk.js","sourcesContent":["module.exports = \"attribute vec4 vPosition;\\nvoid main() {\\n\\tgl_Position = vPosition;\\n}\\n\"","module.exports = \"precision mediump float;\\nvoid main() {\\n\\tgl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\\n}\\n\"","module.exports = \"attribute vec4 vPosition;\\nvoid main() {\\n\\tgl_Position = vPosition;\\n}\\n\"","module.exports = \"precision mediump float;\\nvoid main() {\\n\\tgl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\\n}\\n\"","module.exports = \"attribute vec4 vPosition;\\nvarying vec4 fColor;\\nvoid main() {\\n\\tfColor = vec4((1.0 + vPosition.xyz) / 2.0, 1.0);\\n\\tgl_Position = vPosition;\\n}\\n\"","module.exports = \"precision mediump float;\\nvarying vec4 fColor;\\nvoid main() {\\n\\tgl_FragColor = fColor;\\n}\\n\"","module.exports = \"attribute vec3 vPosition;\\nattribute vec3 vColor;\\nvarying vec4 color;\\nvoid main() {\\n\\tgl_Position = vec4(vPosition, 1.0);\\n\\tcolor = vec4(vColor, 1.0);\\n}\\n\"","module.exports = \"precision mediump float;\\nvarying vec4 color;\\nvoid main() {\\n\\tgl_FragColor = color;\\n}\\n\"","var _path;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgGithub(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    className: \"inline\",\n    width: \"1.2em\",\n    height: \"1.2em\",\n    preserveAspectRatio: \"xMidYMid meet\",\n    viewBox: \"0 0 24 24\",\n    \"data-v-939756fc\": \"\",\n    style: {\n      verticalAlign: \"sub\"\n    },\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M10.07 20.503a1 1 0 0 0-1.18-.983c-1.31.24-2.963.276-3.402-.958a5.708 5.708 0 0 0-1.837-2.415a1.2 1.2 0 0 1-.167-.11a1 1 0 0 0-.93-.645h-.005a1 1 0 0 0-1 .995c-.004.815.81 1.338 1.141 1.514a4.44 4.44 0 0 1 .924 1.36c.365 1.023 1.423 2.576 4.466 2.376l.003.098l.004.268a1 1 0 0 0 2 0l-.005-.318c-.005-.19-.012-.464-.012-1.182zM20.737 5.377c.032-.125.063-.264.09-.42a6.278 6.278 0 0 0-.408-3.293a1.002 1.002 0 0 0-.615-.58c-.356-.12-1.67-.357-4.184 1.25a13.87 13.87 0 0 0-6.354 0C6.762.75 5.455.966 5.102 1.079a.997.997 0 0 0-.631.584a6.3 6.3 0 0 0-.404 3.357c.025.127.051.246.079.354a6.27 6.27 0 0 0-1.256 3.83a8.422 8.422 0 0 0 .043.921c.334 4.603 3.334 5.984 5.424 6.459a4.591 4.591 0 0 0-.118.4a1 1 0 0 0 1.942.479a1.678 1.678 0 0 1 .468-.878a1 1 0 0 0-.546-1.745c-3.454-.395-4.954-1.802-5.18-4.899a6.61 6.61 0 0 1-.033-.738a4.258 4.258 0 0 1 .92-2.713a3.022 3.022 0 0 1 .195-.231a1 1 0 0 0 .188-1.025a3.388 3.388 0 0 1-.155-.555a4.094 4.094 0 0 1 .079-1.616a7.543 7.543 0 0 1 2.415 1.18a1.009 1.009 0 0 0 .827.133a11.777 11.777 0 0 1 6.173.001a1.005 1.005 0 0 0 .83-.138a7.572 7.572 0 0 1 2.406-1.19a4.04 4.04 0 0 1 .087 1.578a3.205 3.205 0 0 1-.169.607a1 1 0 0 0 .188 1.025c.078.087.155.18.224.268A4.122 4.122 0 0 1 20 9.203a7.039 7.039 0 0 1-.038.777c-.22 3.056-1.725 4.464-5.195 4.86a1 1 0 0 0-.546 1.746a1.63 1.63 0 0 1 .466.908a3.06 3.06 0 0 1 .093.82v2.333c-.01.648-.01 1.133-.01 1.356a1 1 0 1 0 2 0c0-.217 0-.692.01-1.34v-2.35a4.881 4.881 0 0 0-.155-1.311a4.256 4.256 0 0 0-.116-.416a6.513 6.513 0 0 0 5.445-6.424A8.697 8.697 0 0 0 22 9.203a6.13 6.13 0 0 0-1.263-3.826z\",\n    fill: \"currentColor\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgGithub);\nexport default __webpack_public_path__ + \"static/media/github.0d3f3caa.svg\";\nexport { ForwardRef as ReactComponent };","export const githubSrc = 'https://github.com/EchoZhaoH';\n\nexport const activeDepot = [\n  {\n    url: 'https://github.com/EchoZhaoH/vscode-lsp-demo',\n    title: 'Vscode Lsp Demo (一个中文格式化插件)'\n  },\n  {\n    url: 'https://github.com/EchoZhaoH/learn-rust',\n    title: 'Rust 学习'\n  }\n]\n","import { Link } from 'react-router-dom'\nimport { ReactComponent as Github} from '@assets/svg/github.svg';\nimport { githubSrc } from '@/data';\n\nexport function Header() {\n  return (\n    <div className=\"flex flex-row px-10 mt-10\">\n      <Link to=\"/\">\n        Echo\n      </Link>\n      <a href={githubSrc} title=\"github\" className=\"ml-4\">\n        <Github />\n      </a>\n      <span className=\"flex-1\"></span>\n      <Link to=\"/articles\">\n        随想\n      </Link>\n      <Link to=\"/webgl\" className=\"ml-4\">\n         WebGl\n      </Link>\n      <Link to=\"/graffiti\" className=\"ml-4\">\n        🖼\n      </Link>\n    </div>\n  )\n}\n","import React, { useEffect } from 'react';\nimport { IApplicationOptions } from 'pixi.js'\nimport { Application } from '@pixi/app';\nimport { Renderer } from '@pixi/core';\nimport { Ticker, TickerPlugin } from '@pixi/ticker';\nimport { InteractionManager } from '@pixi/interaction';\nimport { Live2DModel, InternalModel } from 'pixi-live2d-display';\n\n// register the Ticker to support automatic updating of Live2D models\nApplication.registerPlugin(TickerPlugin);\nLive2DModel.registerTicker(Ticker);\n\n// register the InteractionManager to support automatic interaction of Live2D models\nRenderer.registerPlugin('interaction', InteractionManager);\n\n\ninterface Options extends Omit<IApplicationOptions, 'view'> {\n  modelUrl?: string;\n  onLoad?: (ls: Live2DModel<InternalModel>) => void\n}\nconst deafaultUrl = 'model/tororo.model.json'\nexport function useLiveWidget(ref: React.RefObject<HTMLCanvasElement>, options: Options) {\n  const {\n    modelUrl,\n    onLoad,\n    ...rest\n  } = options\n  useEffect(() => {\n    if (!ref.current) {\n      return\n    }\n    async function init() {\n      const app = new Application({\n        ...rest,\n        view: ref.current\n      })\n      const live2dSprite = await Live2DModel.from(modelUrl || deafaultUrl);\n      (live2dSprite as any).scale.set(0.08);\n      (live2dSprite as any).position.set(30, 5)\n      app.stage.addChild(live2dSprite as any);\n      onLoad && onLoad(live2dSprite)\n    }\n    init()\n  }, [ref, rest, modelUrl, onLoad])\n}\n","import { useLiveWidget } from \"@/hooks/usePat\"\nimport classNames from \"classnames\"\nimport { useRef } from \"react\"\n\ninterface Props {\n  className?: string;\n}\n\nexport function Pet(props: Props) {\n  const {\n    className\n  } = props\n  const ref = useRef<HTMLCanvasElement | null>(null)\n  const cns = classNames(\"mx-auto rounded-1/2\", className)\n  useLiveWidget(ref, {\n    width: 200,\n    height: 200,\n    backgroundColor: 0x4e4c4c\n  })\n  return (\n    <canvas ref={ref} className={cns} />\n  )\n}","import './style.scss'\nimport TypeIt from 'typeit-react';\nimport { Header } from '@components/header';\nimport { Pet } from '@/components/pet'\nimport { activeDepot } from '@/data';\n\nexport function Entry() {\n  return (\n    <>\n      <Header />\n      <Pet className=\"mt-20\" />\n      <div className=\"content mt-4\">\n        <TypeIt\n          as=\"div\"\n          options={{\n            cursor: false\n          } as any}\n        >\n          <div>\n            <h4 className=\"text-center\">Hi 我是 Echo</h4>\n            <p className=\"mgt-l mgl-l mgr-l text-center\"><span>前端工程师，喜欢摄影，目前正在学习 rust。</span>\n            </p>\n          </div>\n        </TypeIt>\n      <div className=\"mt-4\">\n          <h4 className=\"text-center mt-4 font-700\">目前正在更新的仓库</h4>\n          <ul className=\"text-center\">\n            {activeDepot.map(d => (\n              <li key={d.url}>\n                <a href={d.url}>{d.title}</a>\n              </li>\n            ))}\n          </ul>\n      </div>\n      </div>\n    </>\n  );\n}\n","import React from 'react';\nimport { Entry } from '@components/entry';\n\nfunction App() {\n  return (\n    <Entry />\n  );\n}\n\nexport default App\n","import { RefObject, useEffect, useState } from \"react\";\n\nexport function useWebGL(ref: RefObject<HTMLCanvasElement>) {\n  const [gl, setGl] = useState<WebGLRenderingContext | null>(null)\n  useEffect(() => {\n    const canvas = ref.current\n    if (!canvas) {\n      return\n    }\n    const gl = canvas.getContext('webgl')\n    gl.viewport(0, 0, canvas.width, canvas.height)\n    gl.clearColor(1.0, 1.0, 1.0, 1.0)\n    setGl(gl)\n  }, [ref])\n  return gl\n}\n\n","import { request } from \"@/api\";\nimport { useEffect, useState } from \"react\";\n\nexport function useGet<T>(url: string, initData: T, opts?: RequestInit) {\n  const [ loading, setLoading ] = useState<boolean>(false)\n  const [data, setData] = useState<T>(initData)\n  useEffect(() => {\n    setLoading(true)\n    request<T>(url, opts).then((res: T) => {\n      setData(res)\n    }).finally(() => {\n      setLoading(false)\n    })\n  }, [url, opts])\n  return {\n    fetching: loading,\n    data\n  }\n}","export function request<T>(input: RequestInfo, option?: RequestInit) {\n  return fetch(input, option).then(res => {\n    const status = res.status\n    if (status === 200 && res.ok) {\n      return res.json() as Promise<T>\n    } else {\n      throw Error('request error')\n    }\n  }).catch(e => {\n    console.log(e.message)\n  })\n}\n","import classNames from 'classnames'\nimport { Link } from 'react-router-dom'\n\ninterface BackProps {\n  url?: string;\n  className?: string;\n}\n\nexport function Back(props: BackProps) {\n  const {\n    url = '/',\n    className\n  } = props\n  const cns = classNames(className, 'mt-10', 'inline-block')\n  return (\n    <Link to={url} className={cns}>\n      cd ..\n    </Link>\n  )\n}","import { ArticleOption } from \"@/types/article\";\nimport { Link } from \"react-router-dom\"\n\ninterface Props {\n  data: ArticleOption;\n}\nexport function ArticleItem(props: Props) {\n  const {\n    data\n  } = props\n  return (\n    <section className=\"not-last:mt-5\">\n      <Link to={`articles/${data.id}`} className=\"inline-block text-lg\"><h3>{data.title}</h3></Link>\n      <p className=\"mt-2 light:text-gray-500\"><span>{data.date}</span>{data.tag && <sup className=\"ml-2 px-1 rounded-sm border light:border-gray-500\">{data.tag}</sup>}</p>\n      <p className=\"mt-2 light:text-gray-500\">{data.body}</p>\n    </section>\n  )\n}","import { useGet } from \"@/hooks\"\nimport { ArticleOption } from \"@/types/article\"\nimport { Back } from '@components/back'\nimport { ArticleItem } from './item'\n\nimport \"./style.scss\"\n\nexport function Archive() {\n  const { data} = useGet<ArticleOption[]>('/articles/list.json', [])\n  return (\n    <div className=\"py-4 mx-auto sm:w-screen-sm <sm:px-4\">\n      {data.map(d => (\n        <ArticleItem data={d} key={d.id} />\n      ))}\n      <Back />\n    </div>\n  )\n}","import { RouterProps } from \"react-router-dom\"\nimport { ArticleOption } from \"@/types/article\"\nimport { useGet } from \"@/hooks\"\nimport classNames from \"classnames\"\nimport { Back } from '@components/back'\n\ninterface ArticleProps extends RouterProps {\n  id: string;\n}\n\nexport function Article(props: ArticleProps) {\n  const { data } = useGet<ArticleOption>(`/articles/${props.id}.json`, {} as ArticleOption)\n  return (\n    <div className=\"py-4 mx-auto sm:w-screen-sm <sm:px-4\">\n      <h4 className=\"text-lg\">\n        {data.title}\n      </h4>\n      <div className={classNames('mgt-s')}>\n        {!!data.tag && <span className=\"mgr-s\">{data.tag}</span>}\n        <span>{data.date}</span>\n      </div>\n      <article className={classNames('mgt-l', 'prose')} dangerouslySetInnerHTML={{ __html: data.body }}></article>\n      <Back url=\"/articles\" />\n    </div>\n  )\n}\n","export enum ActionType {\n  NONE,\n  PEN\n}\n","export abstract class GraffitiShape {\n  abstract init(): void;\n  abstract destroy(): void;\n}\n","import Konva from 'konva';\nimport { Node, NodeConfig } from 'konva/lib/Node'\nimport type { GraffitiBoard } from './index';\nimport { GraffitiShape } from \"./shaps\";\nimport { v4 as uuid } from 'uuid';\nimport { ActionType } from './types';\n\nexport class GraffitiTransformer extends GraffitiShape {\n  renderer: GraffitiBoard;\n  id: string;\n  private transformer: Konva.Transformer;\n  private selectionRectangle: Konva.Rect;\n  private transformerID: string;\n  private selectionRectangleID: string;\n  rect: {\n    x1: number;\n    y1: number;\n    x2: number;\n    y2: number;\n  }\n  constructor(renderer: GraffitiBoard) {\n    super();\n    this.renderer = renderer;\n    this.id = uuid();\n    this.rect = {\n      x1: 0,\n      y1: 0,\n      x2: 0,\n      y2: 0\n    };\n    this.transformerID = `selection-t-${this.id}`;\n    this.selectionRectangleID = `selection-r-${this.id}`;\n  }\n  \n  init() {\n    const renderer = this.renderer;\n    this.transformer = new Konva.Transformer({\n      id: this.transformerID,\n      borderDash: [3, 3],\n      borderStroke: 'blue',\n      anchorFill: 'red'\n    });\n    this.selectionRectangle = new Konva.Rect({\n      id: this.selectionRectangleID,\n      fill: 'rgba(0, 0, 255, 0.5)',\n      visible: false\n    });\n    renderer.addShape(this.transformer, this.selectionRectangle);\n    this.initListeners();\n  }\n\n  initListeners() {\n    const renderer = this.renderer;\n    const stage = renderer.stage;\n    stage.on('click tab', (e) => {\n      const action  = renderer.action;\n      if (action !== ActionType.NONE) {\n        return;\n      }\n\n      if (this.selectionRectangle.visible()) {\n        return;\n      }\n  \n      // if click on empty area - remove all selections\n      if (e.target === stage) {\n        this.transformer.nodes([]);\n        return;\n      }\n      if (e.target.nodeType !== 'Shape') {\n        return;\n      }\n      // do we pressed shift or ctrl?\n      const metaPressed = e.evt.shiftKey || e.evt.ctrlKey || e.evt.metaKey;\n      const isSelected = this.transformer.nodes().indexOf(e.target) >= 0;\n      if (!metaPressed && !isSelected) {\n        // if no key pressed and the node is not selected\n        // select just one\n        this.transformer.nodes([e.target]);\n      } else if (metaPressed && isSelected) {\n        // if we pressed keys and node was selected\n        // we need to remove it from selection:\n        const nodes = this.transformer.nodes().slice(); // use slice to have new copy of array\n        // remove node from array\n        nodes.splice(nodes.indexOf(e.target), 1);\n        this.transformer.nodes(nodes);\n      } else if (metaPressed && !isSelected) {\n        // add the node into selection\n        const nodes = this.transformer.nodes().concat([e.target]);\n        this.transformer.nodes(nodes);\n      }\n    })\n    stage.on('mousedown touchstart', e => {\n      const action  = renderer.action;\n      if (action !== ActionType.NONE) {\n        return;\n      }\n      if (e.target !== stage) {\n        return;\n      }\n      e.evt.preventDefault();\n      this.rect = {\n        x1: stage.getPointerPosition().x,\n        x2: stage.getPointerPosition().x,\n        y1: stage.getPointerPosition().y,\n        y2: stage.getPointerPosition().y\n      };\n      this.selectionRectangle.visible(true);\n      this.selectionRectangle.width(0);\n      this.selectionRectangle.height(0);\n    })\n    stage.on('mousemove touchmove', (e) => {\n      const action  = renderer.action;\n      if (action !== ActionType.NONE) {\n        return;\n      }\n      // do nothing if we didn't start selection\n      if (!this.selectionRectangle.visible()) {\n        return;\n      }\n      e.evt.preventDefault();\n      this.rect.x2 = stage.getPointerPosition().x;\n      this.rect.y2 = stage.getPointerPosition().y;\n      const {\n        x1, x2, y1, y2\n      } = this.rect;\n      this.selectionRectangle.setAttrs({\n        x: Math.min(x1, x2),\n        y: Math.min(y1, y2),\n        width: Math.abs(x2 - x1),\n        height: Math.abs(y2 - y1),\n      });\n    });\n    stage.on('mouseup touchend', (e) => {\n      const action  = renderer.action;\n      if (action !== ActionType.NONE) {\n        return;\n      }\n      // do nothing if we didn't start selection\n      if (!this.selectionRectangle.visible()) {\n        return;\n      }\n      e.evt.preventDefault();\n      // update visibility in timeout, so we can check it in click event\n      setTimeout(() => {\n        this.selectionRectangle.visible(false);\n      });\n      const shapes = stage.find('Shape');\n      const box = this.selectionRectangle.getClientRect();\n      const selected = shapes.filter((shape) => {\n        const shapeID = shape.id();\n        if (shapeID === this.transformerID || shapeID === this.selectionRectangleID) {\n          return false\n        }\n        return Konva.Util.haveIntersection(box, shape.getClientRect())\n      });\n      this.transformer.nodes(selected);\n    });\n  }\n\n  destroy() {\n    const renderer = this.renderer;\n    const stage = renderer.stage;\n    stage.off('click tab');\n    stage.off('mouseup touchend');\n    stage.off('mousemove touchmove');\n    stage.off('mousedown touchstart');\n  }\n\n  addNodes(nodes: Node<NodeConfig>[]) {\n    this.transformer.nodes(nodes);\n  }\n}\n","import Konva from 'konva';\nimport type { GraffitiBoard } from './index'\nimport { ActionType } from './types';\nimport { v4 as uuid } from 'uuid';\nimport { GraffitiShape } from './shaps';\n\nexport class GraffitiLine extends GraffitiShape {\n  renderer: GraffitiBoard;\n\n  lines: Konva.Line[];\n  painting: boolean;\n  constructor(renderer: GraffitiBoard) {\n    super()\n    this.renderer = renderer;\n    this.lines = [];\n    this.painting = false;\n  }\n  init() {\n    this.initStageListeners();\n    this.initRendererEvents();\n  }\n\n  initStageListeners() {\n    const stage = this.renderer.stage;\n    // mousedown\n    stage.on('mousedown touchstart', () => {\n      if (!this.isPenAction) {\n        return;\n      }\n      const line = new Konva.Line({\n        id: uuid(),\n        fill: 'red',\n        stroke: 'red',\n        strokeWidth: 2\n      });\n      this.lines.push(line);\n      this.renderer.addShape(line);\n      this.painting = true\n    });\n    // mouseup\n    stage.on('mouseup touchend', () => {\n      if (!this.isPenAction) {\n        return\n      }\n      this.painting = false;\n    });\n    // mouse move\n    stage.on('mousemove touchmove', (e) => {\n      if (!this.isPenAction || !this.painting) {\n        return\n      }\n      if (e.target !== stage) {\n        return;\n      }\n      const line = this.lines[this.lines.length - 1];\n      const point = [\n        stage.getPointerPosition().x,\n        stage.getPointerPosition().y\n      ];\n      line.points(line.points().concat(point));\n    })\n  }\n\n  initRendererEvents() {\n    const renderer = this.renderer;\n    renderer.on<ActionType>('action:change', (action) => {\n      if (action !== ActionType.PEN) {\n        this.painting = false;\n      }\n    })\n  }\n\n  destroy() {\n    const stage = this.renderer.stage;\n    stage.off('mousedown touchstart');\n    stage.off('mouseup touchend');\n    stage.off('mousemove touchmove');\n    this.renderer.off('action:change');\n  }\n\n  get isPenAction() {\n    return this.renderer.action === ActionType.PEN;\n  }\n}\n","export type Listener<P = any, R = void> = (p: P) => R;\n\nexport class Emitter {\n  private listeners: Record<string, Listener[]>\n  constructor() {\n    this.listeners = {};\n  }\n\n  on<T, P = void>(key: string, fn: Listener<T, P>) {\n    if (!this.listeners[key]) {\n      this.listeners[key] = [fn];\n    } else {\n      this.listeners[key].push(fn);\n    }\n  }\n\n  emit<P>(key: string, p?: P) {\n    const listener = this.listeners[key];\n    if (!listener) {\n      return\n    }\n    listener.forEach(fn => fn(p));\n  }\n\n  off(key: string) {\n    const listener = this.listeners[key];\n    if (!listener) {\n      return\n    }\n    this.listeners[key] = [];\n  }\n}","import { GraffitiTransformer } from './transformer';\nimport Konva from 'konva'\nimport { ShapeConfig, Shape } from 'konva/lib/Shape'\nimport type { StageConfig } from 'konva/lib/Stage'\nimport { v4 as uuid } from 'uuid'\nimport { GraffitiLine } from './line';\nimport { Emitter } from './emmiter';\nimport { GraffitiShape } from './shaps';\nimport { ActionType } from './types';\n\nconst {\n  Stage,\n  Layer,\n  Line\n} = Konva\n\nexport class GraffitiBoard extends Emitter {\n  id: string;\n  stage: Konva.Stage;\n  layers: Konva.Layer[];\n  activeLayer: Konva.Layer;\n  action: ActionType;\n  cursor: string;\n  shapes: GraffitiShape[];\n  constructor(container: HTMLDivElement | string, config: Omit<StageConfig, 'container'>) {\n    super();\n    this.stage = new Stage({\n      container,\n      ...config\n    });\n    this.id = uuid();\n    this.activeLayer = new Layer();\n    this.layers = [this.activeLayer];\n    this.action = ActionType.NONE;\n    this.cursor = 'grab';\n    this.stage.add(this.activeLayer);\n    this.setCursor();\n    this.shapes = [\n      new GraffitiLine(this),\n      new GraffitiTransformer(this)\n    ];\n    this.initShapes();\n    this.autoResize();\n  }\n\n  setCursor(cursor?: string) {\n    this.stage.container().style.cursor = cursor || this.cursor;\n    if (cursor) {\n      this.cursor = cursor;\n    }\n  }\n\n  setAction(action: ActionType) {\n    this.action = action;\n    switch(this.action) {\n      case ActionType.NONE:\n        this.cursor = 'grab';\n        break;\n      case ActionType.PEN:\n        this.cursor = 'pointer';\n        break;\n      default:\n        break;\n    }\n    this.emit('action:change', this.action);\n    this.setCursor();\n  }\n\n  addShape(...node: (Konva.Group | Shape<ShapeConfig>)[]) {\n    this.activeLayer.add(...node);\n  }\n\n  private initShapes() {\n    this.shapes.forEach(shape => {\n      shape.init()\n    })\n  }\n\n  destroy() {\n    this.shapes.forEach(shape => {\n      shape.destroy()\n    })\n  }\n\n  autoResize() {\n    window.addEventListener('resize', () => {\n      this.stage.width(window.innerWidth);\n      this.stage.height(window.innerHeight);\n    })\n  }\n}","export function HeaderToolbar() {\n  return (\n    <div className=\"fixed left-half transform -translate-x-1/2 dark:bg-light-100 rounded-sm z-60\">\n      <button className=\"px-4 py-2 dark:text-dark-100\">\n        <i className=\"icon-undo dark:text-dark-100\" />\n      </button>\n      <button className=\"px-4 py-2 dark:text-dark-100\">\n        <i className=\"icon-redo dark:text-dark-100\" />\n      </button>\n    </div>\n  )\n}\n","import { createPopper, Instance } from '@popperjs/core'\nimport { ReactNode, useCallback, useEffect, useRef } from 'react'\nimport './style.scss';\n\nexport interface PopoverProps {\n  children: ReactNode;\n  content: ReactNode;\n}\n\nexport function Popover(props: PopoverProps) {\n  const { children, content } = props;\n  const triggerRef = useRef<HTMLSpanElement>(null);\n  const tooltipRef = useRef<HTMLDivElement>(null);\n  const popperInstance = useRef <Instance>(null);\n  const show = useCallback(() => {\n    if (!popperInstance.current || !tooltipRef.current) {\n      return\n    }\n    // Make the tooltip visible\n    tooltipRef.current.setAttribute('data-show', '');\n\n    // Enable the event listeners\n    popperInstance.current.setOptions((options) => ({\n      ...options,\n      modifiers: [\n        ...options.modifiers,\n        { name: 'eventListeners', enabled: true },\n      ],\n    }));\n\n    // Update its position\n    popperInstance.current.update();\n  }, [popperInstance, tooltipRef])\n  const hidden = useCallback(() => {\n    if (!popperInstance.current || !tooltipRef.current) {\n      return\n    }\n    // Hide the tooltip\n    tooltipRef.current.removeAttribute('data-show');\n\n    // Disable the event listeners\n    popperInstance.current.setOptions((options) => ({\n      ...options,\n      modifiers: [\n        ...options.modifiers,\n        { name: 'eventListeners', enabled: false },\n      ],\n    }));\n  }, [popperInstance, tooltipRef])\n  useEffect(() => {\n    if (!triggerRef.current || !tooltipRef.current) {\n      return\n    }\n    const trigger = triggerRef.current;\n    const tooltip = tooltipRef.current;\n    popperInstance.current = createPopper(trigger, tooltip, {\n      placement: 'right'\n    })\n    const showEvents = ['mouseenter', 'focus'];\n    const hideEvents = ['mouseleave', 'blur'];\n    \n    showEvents.forEach((event) => {\n      trigger.addEventListener(event, show);\n    });\n\n    hideEvents.forEach((event) => {\n      trigger.addEventListener(event, hidden);\n    });\n\n\n\n    return () => {\n      showEvents.forEach((event) => {\n        trigger.removeEventListener(event, show);\n      });\n\n      hideEvents.forEach((event) => {\n        trigger.removeEventListener(event, hidden);\n      });\n    }\n\n  }, [triggerRef, tooltipRef, show, hidden])\n  return (\n    <>\n      <span className=\"block\" ref={triggerRef}>\n        {children}\n      </span>\n      <div id=\"tooltip\" role=\"tooltip\" ref={tooltipRef}>\n        <div id=\"arrow\" data-popper-arrow></div>\n        {content}\n      </div>\n    </>\n  )\n}","import { Popover } from \"@/components/popover\"\nimport { ActionType } from \"../../canvas/types\"\n\nexport interface ActionToolbarProps {\n  onAction: (action: ActionType) => void\n}\n\nexport function ActionToolbar(props: ActionToolbarProps) {\n  const { onAction } = props\n  return (\n    <div className=\"fixed left-5 top-half -translate-y-1/2 dark:bg-light-100 rounded-sm not-last:m-2 z-60 p-1\">\n      <div>\n        <button \n          className=\"w-38px h-38px flex items-center justify-center dark:text-dark-100 border-1 border-gray-100 hover:bg-gray-300 rounded-half\"\n          onClick={() => onAction(ActionType.PEN)}\n        >\n          <i className=\"icon-pen dark:text-dark-100\" />\n        </button>\n      </div>\n      <div>\n        <Popover\n          content=\"111\"\n        >\n          <button \n            className=\"w-38px h-38px flex items-center justify-center dark:text-dark-100 border-1 border-gray-100 hover:bg-gray-300 rounded-half\"\n            onClick={() => onAction(ActionType.NONE)}\n          >\n            <i className=\"icon-shape-circle dark:text-dark-100\" />\n          </button>\n        </Popover>\n      </div>\n    </div>\n  )\n}\n","import { useEffect, useRef } from \"react\"\nimport { GraffitiBoard } from \"./canvas\"\nimport { ActionToolbar, HeaderToolbar } from \"./components/toolbar\"\n\nexport function Graffiti() {\n  const ref = useRef<HTMLDivElement | null>(null)\n  const stage = useRef<GraffitiBoard | null>(null)\n  useEffect(() => {\n    if (!ref.current) {\n      return\n    }\n    stage.current = new GraffitiBoard(ref.current, {\n      width: window.innerWidth,\n      height: window.innerHeight\n    })\n  }, [ref])\n  return (\n    <div>\n      <HeaderToolbar />\n      <ActionToolbar \n        onAction={(action) => {\n          if (!stage.current) {\n            return\n          }\n          stage.current.setAction(action);\n        }}\n      />\n      <div ref={(refEl) => ref.current = refEl}></div>\n    </div>\n  )\n}\n","export default __webpack_public_path__ + \"static/media/stage-1.ea9dd4be.jpeg\";","import { useEffect, useRef } from 'react';\nimport * as THREE from 'three';\n\nimport bgImg from '@assets/images/stage-1.jpeg';\n\nexport default function VWorld() {\n  const ref = useRef<HTMLDivElement>(null);\n\n  // 创建场景\n  useEffect(() => {\n    const el = ref.current;\n    if (!el) {\n      return;\n    }\n    const scene = new THREE.Scene();\n    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\n\n    const renderer = new THREE.WebGLRenderer();\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    el.appendChild(renderer.domElement);\n\n    const geometry = new THREE.SphereGeometry();\n    const material = new THREE.MeshBasicMaterial({\n      map: new THREE.TextureLoader().load(bgImg),\n    });\n    const cube = new THREE.Mesh(geometry, material);\n    scene.add(cube);\n    const bgTexture = new THREE.TextureLoader().load(bgImg);\n    bgTexture.mapping = THREE.CubeRefractionMapping;\n    bgTexture.wrapS = THREE.RepeatWrapping;\n    bgTexture.wrapT = THREE.RepeatWrapping;\n    bgTexture.repeat.set(1, 1);\n    scene.background = bgTexture;\n\n    camera.position.z = 5;\n    let timer: number | null = null;\n    const animate = function () {\n      timer = requestAnimationFrame(animate);\n\n      cube.rotation.x += 0.01;\n      cube.rotation.y += 0.01;\n\n      renderer.render(scene, camera);\n    };\n    animate();\n    return () => {\n      cancelAnimationFrame(timer);\n    };\n  }, []);\n  return (\n    <div ref={ref} />\n  );\n}\n","//////////////////////////////////////////////////////////////////////////////\n/*eslint-disable*/\n//\n//  Angel.js\n//\n//////////////////////////////////////////////////////////////////////////////\n\n//----------------------------------------------------------------------------\n//\n//  Helper export functions\n//\n\nexport function _argumentsToArray(args) {\n  return [...args];\n}\n\n//----------------------------------------------------------------------------\n\nexport function radians(degrees) {\n  return degrees * Math.PI / 180.0;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Vector Constructors\n//\n\nexport function vec2() {\n  const result = _argumentsToArray(arguments);\n  switch (result.length) {\n    case 0: result.push(0.0);\n    case 1: result.push(0.0);\n  }\n  return result.splice(0, 2);\n}\n\nexport function vec3() {\n  const result = _argumentsToArray(arguments);\n\n  switch (result.length) {\n    case 0: result.push(0.0);\n    case 1: result.push(0.0);\n    case 2: result.push(0.0);\n  }\n\n  return result.splice(0, 3);\n}\n\nexport function vec4() {\n  const result = _argumentsToArray(arguments);\n\n  switch (result.length) {\n    case 0: result.push(0.0);\n    case 1: result.push(0.0);\n    case 2: result.push(0.0);\n    case 3: result.push(1.0);\n  }\n\n  return result.splice(0, 4);\n}\n\n//----------------------------------------------------------------------------\n//\n//  Matrix Constructors\n//\n\nexport function mat2() {\n  const v = _argumentsToArray(arguments);\n\n  let m = [];\n  switch (v.length) {\n    case 0:\n      v[0] = 1;\n    case 1:\n      m = [\n        vec2(v[0], 0.0),\n        vec2(0.0, v[0])\n      ];\n      break;\n\n    default:\n      m.push(vec2(v)); v.splice(0, 2);\n      m.push(vec2(v));\n      break;\n  }\n\n  m.matrix = true;\n\n  return m;\n}\n\n//----------------------------------------------------------------------------\n\nexport function mat3() {\n  const v = _argumentsToArray(arguments);\n\n  let m = [];\n  switch (v.length) {\n    case 0:\n      v[0] = 1;\n    case 1:\n      m = [\n        vec3(v[0], 0.0, 0.0),\n        vec3(0.0, v[0], 0.0),\n        vec3(0.0, 0.0, v[0])\n      ];\n      break;\n\n    default:\n      m.push(vec3(v)); v.splice(0, 3);\n      m.push(vec3(v)); v.splice(0, 3);\n      m.push(vec3(v));\n      break;\n  }\n\n  m.matrix = true;\n\n  return m;\n}\n\n//----------------------------------------------------------------------------\n\nexport function mat4() {\n  const v = _argumentsToArray(arguments);\n\n  let m = [];\n  switch (v.length) {\n    case 0:\n      v[0] = 1;\n    case 1:\n      m = [\n        vec4(v[0], 0.0, 0.0, 0.0),\n        vec4(0.0, v[0], 0.0, 0.0),\n        vec4(0.0, 0.0, v[0], 0.0),\n        vec4(0.0, 0.0, 0.0, v[0])\n      ];\n      break;\n\n    default:\n      m.push(vec4(v)); v.splice(0, 4);\n      m.push(vec4(v)); v.splice(0, 4);\n      m.push(vec4(v)); v.splice(0, 4);\n      m.push(vec4(v));\n      break;\n  }\n\n  m.matrix = true;\n\n  return m;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Generic Mathematical Operations for Vectors and Matrices\n//\n\nexport function equal(u, v) {\n  if (u.length != v.length) { return false; }\n\n  if (u.matrix && v.matrix) {\n    for (var i = 0; i < u.length; ++i) {\n      if (u[i].length != v[i].length) { return false; }\n      for (let j = 0; j < u[i].length; ++j) {\n        if (u[i][j] !== v[i][j]) { return false; }\n      }\n    }\n  }\n  else if (u.matrix && !v.matrix || !u.matrix && v.matrix) {\n    return false;\n  }\n  else {\n    for (var i = 0; i < u.length; ++i) {\n      if (u[i] !== v[i]) { return false; }\n    }\n  }\n\n  return true;\n}\n\n//----------------------------------------------------------------------------\n\nexport function add(u, v) {\n  const result = [];\n\n  if (u.matrix && v.matrix) {\n    if (u.length != v.length) {\n      throw \"add(): trying to add matrices of different dimensions\";\n    }\n\n    for (var i = 0; i < u.length; ++i) {\n      if (u[i].length != v[i].length) {\n        throw \"add(): trying to add matrices of different dimensions\";\n      }\n      result.push([]);\n      for (let j = 0; j < u[i].length; ++j) {\n        result[i].push(u[i][j] + v[i][j]);\n      }\n    }\n\n    result.matrix = true;\n\n    return result;\n  }\n  else if (u.matrix && !v.matrix || !u.matrix && v.matrix) {\n    throw \"add(): trying to add matrix and non-matrix variables\";\n  }\n  else {\n    if (u.length != v.length) {\n      throw \"add(): vectors are not the same dimension\";\n    }\n\n    for (var i = 0; i < u.length; ++i) {\n      result.push(u[i] + v[i]);\n    }\n\n    return result;\n  }\n}\n\n//----------------------------------------------------------------------------\n\nexport function subtract(u, v) {\n  const result = [];\n\n  if (u.matrix && v.matrix) {\n    if (u.length != v.length) {\n      throw \"subtract(): trying to subtract matrices\" +\n      \" of different dimensions\";\n    }\n\n    for (var i = 0; i < u.length; ++i) {\n      if (u[i].length != v[i].length) {\n        throw \"subtract(): trying to subtact matrices\" +\n        \" of different dimensions\";\n      }\n      result.push([]);\n      for (let j = 0; j < u[i].length; ++j) {\n        result[i].push(u[i][j] - v[i][j]);\n      }\n    }\n\n    result.matrix = true;\n\n    return result;\n  }\n  else if (u.matrix && !v.matrix || !u.matrix && v.matrix) {\n    throw \"subtact(): trying to subtact  matrix and non-matrix variables\";\n  }\n  else {\n    if (u.length != v.length) {\n      throw \"subtract(): vectors are not the same length\";\n    }\n\n    for (var i = 0; i < u.length; ++i) {\n      result.push(u[i] - v[i]);\n    }\n\n    return result;\n  }\n}\n\n//----------------------------------------------------------------------------\n\nexport function mult(u, v) {\n  const result = [];\n\n  if (u.matrix && v.matrix) {\n    if (u.length != v.length) {\n      throw \"mult(): trying to add matrices of different dimensions\";\n    }\n\n    for (var i = 0; i < u.length; ++i) {\n      if (u[i].length != v[i].length) {\n        throw \"mult(): trying to add matrices of different dimensions\";\n      }\n    }\n\n    for (var i = 0; i < u.length; ++i) {\n      result.push([]);\n\n      for (var j = 0; j < v.length; ++j) {\n        var sum = 0.0;\n        for (let k = 0; k < u.length; ++k) {\n          sum += u[i][k] * v[k][j];\n        }\n        result[i].push(sum);\n      }\n    }\n\n    result.matrix = true;\n\n    return result;\n  }\n\n  if (u.matrix && (u.length == v.length)) {\n    for (var i = 0; i < v.length; i++) {\n      var sum = 0.0;\n      for (var j = 0; j < v.length; j++) {\n        sum += u[i][j] * v[j];\n      }\n      result.push(sum);\n    }\n    return result;\n  }\n\n\n\n  else {\n    if (u.length != v.length) {\n      throw \"mult(): vectors are not the same dimension\";\n    }\n\n    for (var i = 0; i < u.length; ++i) {\n      result.push(u[i] * v[i]);\n    }\n\n    return result;\n  }\n}\n\n//----------------------------------------------------------------------------\n//\n//  Basic Transformation Matrix Generators\n//\n\nexport function translate(x, y, z) {\n  if (Array.isArray(x) && x.length == 3) {\n    z = x[2];\n    y = x[1];\n    x = x[0];\n  }\n\n  const result = mat4();\n  result[0][3] = x;\n  result[1][3] = y;\n  result[2][3] = z;\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n\nexport function rotate(angle, axis) {\n  if (!Array.isArray(axis)) {\n    axis = [arguments[1], arguments[2], arguments[3]];\n  }\n\n  const v = normalize(axis);\n\n  const x = v[0];\n  const y = v[1];\n  const z = v[2];\n\n  const c = Math.cos(radians(angle));\n  const omc = 1.0 - c;\n  const s = Math.sin(radians(angle));\n\n  const result = mat4(\n    vec4(x * x * omc + c, x * y * omc - z * s, x * z * omc + y * s, 0.0),\n    vec4(x * y * omc + z * s, y * y * omc + c, y * z * omc - x * s, 0.0),\n    vec4(x * z * omc - y * s, y * z * omc + x * s, z * z * omc + c, 0.0),\n    vec4()\n  );\n\n  return result;\n}\n\nexport function rotateX(theta) {\n  const c = Math.cos(radians(theta));\n  const s = Math.sin(radians(theta));\n  const rx = mat4(1.0, 0.0, 0.0, 0.0,\n    0.0, c, -s, 0.0,\n    0.0, s, c, 0.0,\n    0.0, 0.0, 0.0, 1.0);\n  return rx;\n}\nexport function rotateY(theta) {\n  const c = Math.cos(radians(theta));\n  const s = Math.sin(radians(theta));\n  const ry = mat4(c, 0.0, s, 0.0,\n    0.0, 1.0, 0.0, 0.0,\n    -s, 0.0, c, 0.0,\n    0.0, 0.0, 0.0, 1.0);\n  return ry;\n}\nexport function rotateZ(theta) {\n  const c = Math.cos(radians(theta));\n  const s = Math.sin(radians(theta));\n  const rz = mat4(c, -s, 0.0, 0.0,\n    s, c, 0.0, 0.0,\n    0.0, 0.0, 1.0, 0.0,\n    0.0, 0.0, 0.0, 1.0);\n  return rz;\n}\n\n\n//----------------------------------------------------------------------------\n\nexport function scalem(x, y, z) {\n  if (Array.isArray(x) && x.length == 3) {\n    z = x[2];\n    y = x[1];\n    x = x[0];\n  }\n\n  const result = mat4();\n  result[0][0] = x;\n  result[1][1] = y;\n  result[2][2] = z;\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//  ModelView Matrix Generators\n//\n\nexport function lookAt(eye, at, up) {\n  if (!Array.isArray(eye) || eye.length != 3) {\n    throw \"lookAt(): first parameter [eye] must be an a vec3\";\n  }\n\n  if (!Array.isArray(at) || at.length != 3) {\n    throw \"lookAt(): first parameter [at] must be an a vec3\";\n  }\n\n  if (!Array.isArray(up) || up.length != 3) {\n    throw \"lookAt(): first parameter [up] must be an a vec3\";\n  }\n\n  if (equal(eye, at)) {\n    return mat4();\n  }\n\n  let v = normalize(subtract(at, eye));  // view direction vector\n  const n = normalize(cross(v, up));       // perpendicular vector\n  const u = normalize(cross(n, v));        // \"new\" up vector\n\n  v = negate(v);\n\n  const result = mat4(\n    vec4(n, -dot(n, eye)),\n    vec4(u, -dot(u, eye)),\n    vec4(v, -dot(v, eye)),\n    vec4()\n  );\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Projection Matrix Generators\n//\n\nexport function ortho(left, right, bottom, top, near, far) {\n  if (left == right) { throw \"ortho(): left and right are equal\"; }\n  if (bottom == top) { throw \"ortho(): bottom and top are equal\"; }\n  if (near == far) { throw \"ortho(): near and far are equal\"; }\n\n  const w = right - left;\n  const h = top - bottom;\n  const d = far - near;\n\n  const result = mat4();\n  result[0][0] = 2.0 / w;\n  result[1][1] = 2.0 / h;\n  result[2][2] = -2.0 / d;\n  result[0][3] = -(left + right) / w;\n  result[1][3] = -(top + bottom) / h;\n  result[2][3] = -(near + far) / d;\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n\nexport function perspective(fovy, aspect, near, far) {\n  const f = 1.0 / Math.tan(radians(fovy) / 2);\n  const d = far - near;\n\n  const result = mat4();\n  result[0][0] = f / aspect;\n  result[1][1] = f;\n  result[2][2] = -(near + far) / d;\n  result[2][3] = -2 * near * far / d;\n  result[3][2] = -1;\n  result[3][3] = 0.0;\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Matrix export functions\n//\n\nexport function transpose(m) {\n  if (!m.matrix) {\n    return \"transpose(): trying to transpose a non-matrix\";\n  }\n\n  const result = [];\n  for (let i = 0; i < m.length; ++i) {\n    result.push([]);\n    for (let j = 0; j < m[i].length; ++j) {\n      result[i].push(m[j][i]);\n    }\n  }\n\n  result.matrix = true;\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Vector export functions\n//\n\nexport function dot(u, v) {\n  if (u.length != v.length) {\n    throw \"dot(): vectors are not the same dimension\";\n  }\n\n  let sum = 0.0;\n  for (let i = 0; i < u.length; ++i) {\n    sum += u[i] * v[i];\n  }\n\n  return sum;\n}\n\n//----------------------------------------------------------------------------\n\nexport function negate(u) {\n  const result = [];\n  for (let i = 0; i < u.length; ++i) {\n    result.push(-u[i]);\n  }\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n\nexport function cross(u, v) {\n  if (!Array.isArray(u) || u.length < 3) {\n    throw \"cross(): first argument is not a vector of at least 3\";\n  }\n\n  if (!Array.isArray(v) || v.length < 3) {\n    throw \"cross(): second argument is not a vector of at least 3\";\n  }\n\n  const result = [\n    u[1] * v[2] - u[2] * v[1],\n    u[2] * v[0] - u[0] * v[2],\n    u[0] * v[1] - u[1] * v[0]\n  ];\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n\nexport function length(u) {\n  return Math.sqrt(dot(u, u));\n}\n\n//----------------------------------------------------------------------------\n\nexport function normalize(u, excludeLastComponent) {\n  if (excludeLastComponent) {\n    var last = u.pop();\n  }\n\n  const len = length(u);\n\n  if (!isFinite(len)) {\n    throw \"normalize: vector \" + u + \" has zero length\";\n  }\n\n  for (let i = 0; i < u.length; ++i) {\n    u[i] /= len;\n  }\n\n  if (excludeLastComponent) {\n    u.push(last);\n  }\n\n  return u;\n}\n\n//----------------------------------------------------------------------------\n\nexport function mix(u, v, s) {\n  if (typeof s !== \"number\") {\n    throw \"mix: the last paramter \" + s + \" must be a number\";\n  }\n\n  if (u.length != v.length) {\n    throw \"vector dimension mismatch\";\n  }\n\n  const result = [];\n  for (let i = 0; i < u.length; ++i) {\n    result.push((1.0 - s) * u[i] + s * v[i]);\n  }\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n//\n// Vector and Matrix export functions\n//\n\nexport function scale(s, u) {\n  if (!Array.isArray(u)) {\n    throw \"scale: second parameter \" + u + \" is not a vector\";\n  }\n\n  const result = [];\n  for (let i = 0; i < u.length; ++i) {\n    result.push(s * u[i]);\n  }\n\n  return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//\n//\n\nexport function flatten(v) {\n  if (v.matrix === true) {\n    v = transpose(v);\n  }\n\n  let n = v.length;\n  let elemsAreArrays = false;\n\n  if (Array.isArray(v[0])) {\n    elemsAreArrays = true;\n    n *= v[0].length;\n  }\n\n  const floats = new Float32Array(n);\n\n  if (elemsAreArrays) {\n    let idx = 0;\n    for (var i = 0; i < v.length; ++i) {\n      for (let j = 0; j < v[i].length; ++j) {\n        floats[idx++] = v[i][j];\n      }\n    }\n  }\n  else {\n    for (var i = 0; i < v.length; ++i) {\n      floats[i] = v[i];\n    }\n  }\n\n  return floats;\n}\n\n//----------------------------------------------------------------------------\n\nexport const sizeof = {\n  'vec2': new Float32Array(flatten(vec2())).byteLength,\n  'vec3': new Float32Array(flatten(vec3())).byteLength,\n  'vec4': new Float32Array(flatten(vec4())).byteLength,\n  'mat2': new Float32Array(flatten(mat2())).byteLength,\n  'mat3': new Float32Array(flatten(mat3())).byteLength,\n  'mat4': new Float32Array(flatten(mat4())).byteLength\n};\n\n// new export functions 5/2/2015\n\n// printing\n\nexport function printm(m) {\n  if (m.length == 2)\n    for (var i = 0; i < m.length; i++)\n      console.log(m[i][0], m[i][1]);\n  else if (m.length == 3)\n    for (var i = 0; i < m.length; i++)\n      console.log(m[i][0], m[i][1], m[i][2]);\n  else if (m.length == 4)\n    for (var i = 0; i < m.length; i++)\n      console.log(m[i][0], m[i][1], m[i][2], m[i][3]);\n}\n// determinants\n\nexport function det2(m) {\n\n  return m[0][0] * m[1][1] - m[0][1] * m[1][0];\n\n}\n\nexport function det3(m) {\n  const d = m[0][0] * m[1][1] * m[2][2]\n    + m[0][1] * m[1][2] * m[2][0]\n    + m[0][2] * m[2][1] * m[1][0]\n    - m[2][0] * m[1][1] * m[0][2]\n    - m[1][0] * m[0][1] * m[2][2]\n    - m[0][0] * m[1][2] * m[2][1]\n    ;\n  return d;\n}\n\nexport function det4(m) {\n  const m0 = [\n    vec3(m[1][1], m[1][2], m[1][3]),\n    vec3(m[2][1], m[2][2], m[2][3]),\n    vec3(m[3][1], m[3][2], m[3][3])\n  ];\n  const m1 = [\n    vec3(m[1][0], m[1][2], m[1][3]),\n    vec3(m[2][0], m[2][2], m[2][3]),\n    vec3(m[3][0], m[3][2], m[3][3])\n  ];\n  const m2 = [\n    vec3(m[1][0], m[1][1], m[1][3]),\n    vec3(m[2][0], m[2][1], m[2][3]),\n    vec3(m[3][0], m[3][1], m[3][3])\n  ];\n  const m3 = [\n    vec3(m[1][0], m[1][1], m[1][2]),\n    vec3(m[2][0], m[2][1], m[2][2]),\n    vec3(m[3][0], m[3][1], m[3][2])\n  ];\n  return m[0][0] * det3(m0) - m[0][1] * det3(m1)\n    + m[0][2] * det3(m2) - m[0][3] * det3(m3);\n\n}\n\nexport function det(m) {\n  if (m.matrix != true) console.log(\"not a matrix\");\n  if (m.length == 2) return det2(m);\n  if (m.length == 3) return det3(m);\n  if (m.length == 4) return det4(m);\n}\n\n//---------------------------------------------------------\n\n// inverses\n\nexport function inverse2(m) {\n  const a = mat2();\n  const d = det2(m);\n  a[0][0] = m[1][1] / d;\n  a[0][1] = -m[0][1] / d;\n  a[1][0] = -m[1][0] / d;\n  a[1][1] = m[0][0] / d;\n  a.matrix = true;\n  return a;\n}\n\nexport function inverse3(m) {\n  const a = mat3();\n  const d = det3(m);\n\n  const a00 = [\n    vec2(m[1][1], m[1][2]),\n    vec2(m[2][1], m[2][2])\n  ];\n  const a01 = [\n    vec2(m[1][0], m[1][2]),\n    vec2(m[2][0], m[2][2])\n  ];\n  const a02 = [\n    vec2(m[1][0], m[1][1]),\n    vec2(m[2][0], m[2][1])\n  ];\n  const a10 = [\n    vec2(m[0][1], m[0][2]),\n    vec2(m[2][1], m[2][2])\n  ];\n  const a11 = [\n    vec2(m[0][0], m[0][2]),\n    vec2(m[2][0], m[2][2])\n  ];\n  const a12 = [\n    vec2(m[0][0], m[0][1]),\n    vec2(m[2][0], m[2][1])\n  ];\n  const a20 = [\n    vec2(m[0][1], m[0][2]),\n    vec2(m[1][1], m[1][2])\n  ];\n  const a21 = [\n    vec2(m[0][0], m[0][2]),\n    vec2(m[1][0], m[1][2])\n  ];\n  const a22 = [\n    vec2(m[0][0], m[0][1]),\n    vec2(m[1][0], m[1][1])\n  ];\n\n  a[0][0] = det2(a00) / d;\n  a[0][1] = -det2(a10) / d;\n  a[0][2] = det2(a20) / d;\n  a[1][0] = -det2(a01) / d;\n  a[1][1] = det2(a11) / d;\n  a[1][2] = -det2(a21) / d;\n  a[2][0] = det2(a02) / d;\n  a[2][1] = -det2(a12) / d;\n  a[2][2] = det2(a22) / d;\n\n  return a;\n\n}\n\nexport function inverse4(m) {\n  const a = mat4();\n  const d = det4(m);\n\n  const a00 = [\n    vec3(m[1][1], m[1][2], m[1][3]),\n    vec3(m[2][1], m[2][2], m[2][3]),\n    vec3(m[3][1], m[3][2], m[3][3])\n  ];\n  const a01 = [\n    vec3(m[1][0], m[1][2], m[1][3]),\n    vec3(m[2][0], m[2][2], m[2][3]),\n    vec3(m[3][0], m[3][2], m[3][3])\n  ];\n  const a02 = [\n    vec3(m[1][0], m[1][1], m[1][3]),\n    vec3(m[2][0], m[2][1], m[2][3]),\n    vec3(m[3][0], m[3][1], m[3][3])\n  ];\n  const a03 = [\n    vec3(m[1][0], m[1][1], m[1][2]),\n    vec3(m[2][0], m[2][1], m[2][2]),\n    vec3(m[3][0], m[3][1], m[3][2])\n  ];\n  const a10 = [\n    vec3(m[0][1], m[0][2], m[0][3]),\n    vec3(m[2][1], m[2][2], m[2][3]),\n    vec3(m[3][1], m[3][2], m[3][3])\n  ];\n  const a11 = [\n    vec3(m[0][0], m[0][2], m[0][3]),\n    vec3(m[2][0], m[2][2], m[2][3]),\n    vec3(m[3][0], m[3][2], m[3][3])\n  ];\n  const a12 = [\n    vec3(m[0][0], m[0][1], m[0][3]),\n    vec3(m[2][0], m[2][1], m[2][3]),\n    vec3(m[3][0], m[3][1], m[3][3])\n  ];\n  const a13 = [\n    vec3(m[0][0], m[0][1], m[0][2]),\n    vec3(m[2][0], m[2][1], m[2][2]),\n    vec3(m[3][0], m[3][1], m[3][2])\n  ];\n  const a20 = [\n    vec3(m[0][1], m[0][2], m[0][3]),\n    vec3(m[1][1], m[1][2], m[1][3]),\n    vec3(m[3][1], m[3][2], m[3][3])\n  ];\n  const a21 = [\n    vec3(m[0][0], m[0][2], m[0][3]),\n    vec3(m[1][0], m[1][2], m[1][3]),\n    vec3(m[3][0], m[3][2], m[3][3])\n  ];\n  const a22 = [\n    vec3(m[0][0], m[0][1], m[0][3]),\n    vec3(m[1][0], m[1][1], m[1][3]),\n    vec3(m[3][0], m[3][1], m[3][3])\n  ];\n  const a23 = [\n    vec3(m[0][0], m[0][1], m[0][2]),\n    vec3(m[1][0], m[1][1], m[1][2]),\n    vec3(m[3][0], m[3][1], m[3][2])\n  ];\n\n  const a30 = [\n    vec3(m[0][1], m[0][2], m[0][3]),\n    vec3(m[1][1], m[1][2], m[1][3]),\n    vec3(m[2][1], m[2][2], m[2][3])\n  ];\n  const a31 = [\n    vec3(m[0][0], m[0][2], m[0][3]),\n    vec3(m[1][0], m[1][2], m[1][3]),\n    vec3(m[2][0], m[2][2], m[2][3])\n  ];\n  const a32 = [\n    vec3(m[0][0], m[0][1], m[0][3]),\n    vec3(m[1][0], m[1][1], m[1][3]),\n    vec3(m[2][0], m[2][1], m[2][3])\n  ];\n  const a33 = [\n    vec3(m[0][0], m[0][1], m[0][2]),\n    vec3(m[1][0], m[1][1], m[1][2]),\n    vec3(m[2][0], m[2][1], m[2][2])\n  ];\n\n\n\n  a[0][0] = det3(a00) / d;\n  a[0][1] = -det3(a10) / d;\n  a[0][2] = det3(a20) / d;\n  a[0][3] = -det3(a30) / d;\n  a[1][0] = -det3(a01) / d;\n  a[1][1] = det3(a11) / d;\n  a[1][2] = -det3(a21) / d;\n  a[1][3] = det3(a31) / d;\n  a[2][0] = det3(a02) / d;\n  a[2][1] = -det3(a12) / d;\n  a[2][2] = det3(a22) / d;\n  a[2][3] = -det3(a32) / d;\n  a[3][0] = -det3(a03) / d;\n  a[3][1] = det3(a13) / d;\n  a[3][2] = -det3(a23) / d;\n  a[3][3] = det3(a33) / d;\n\n  return a;\n}\nexport function inverse(m) {\n  if (m.matrix != true) console.log(\"not a matrix\");\n  if (m.length == 2) return inverse2(m);\n  if (m.length == 3) return inverse3(m);\n  if (m.length == 4) return inverse4(m);\n}\n\nexport function normalMatrix(m, flag) {\n  let a = mat4();\n  a = inverse(transpose(m));\n  if (flag != true) return a;\n  else {\n    const b = mat3();\n    for (let i = 0; i < 3; i++) for (let j = 0; j < 3; j++) b[i][j] = a[i][j];\n    return b;\n  }\n\n}","export function createShader(gl: WebGLRenderingContext, source: string, type: GLenum) {\n  const shader = gl.createShader(type)\n  gl.shaderSource(shader, source)\n  gl.compileShader(shader)\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    throw Error(`shader ${type} create failed, the error log is: ${gl.getShaderInfoLog(shader)}`)\n  }\n  return shader\n}\n\nexport function createProgram(gl: WebGLRenderingContext, shaders: WebGLShader[]) {\n  const program = gl.createProgram()\n  shaders.forEach(s => {\n    gl.attachShader(program, s)\n  })\n  gl.linkProgram(program)\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n    throw Error(`shader program failed to link, the error log is: ${gl.getProgramInfoLog(program)}`)\n  }\n  return program\n}\n","import { flatten, mix, vec2 } from \"@/common/mv\";\nimport { createProgram, createShader } from \"@/common/shader\";\nimport { useWebGL } from \"@/hooks/useWebGL\";\nimport { useEffect, useRef } from \"react\"\nimport vertex from './shader.vert'\nimport frag from './shader.frag'\n\nexport function Sierpinski() {\n  const ref = useRef<HTMLCanvasElement>(null)\n  const gl = useWebGL(ref)\n  useEffect(() => {\n    if (!gl) {\n      return\n    }\n    const numTimesDivide = 5\n    const pointsCount = Math.pow(3, numTimesDivide + 1);\n    function init() {\n      const vertices = [\n        vec2(-1.0, -1.0),\n        vec2(0.0, 1.0),\n        vec2(1.0, -1.0)\n      ]\n      const points: number[][] = []\n\n      function triangle(a: number[], b: number[], c: number[]) {\n        points.push(a);\n        points.push(b)\n        points.push(c)\n      }\n\n      function divideTriangle(a: number[], b: number[], c: number[], count: number) {\n        if (count === 0) {\n          triangle(a, b, c)\n        } else {\n          const ab = mix(a, b, 0.5)\n          const ac = mix(a, c, 0.5)\n          const bc = mix(b, c, 0.5)\n\n          count -= 1\n\n          divideTriangle(a, ab, ac, count)\n          divideTriangle(c, ac, bc, count)\n          divideTriangle(b, bc, ab, count)\n        }\n      }\n\n      divideTriangle(vertices[0], vertices[1], vertices[2], numTimesDivide)\n      // 创建缓冲区\n      const buffer = gl.createBuffer()\n\n      // gl.ARRAY_BUFFER 表示是顶点数据，现在绑定 buffer 为当前缓冲区\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n\n      // 将数据发送到 GPU 缓存\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(points), gl.STATIC_DRAW)\n    }\n    function render() {\n      gl.clear(gl.COLOR_BUFFER_BIT)\n      gl.drawArrays(gl.TRIANGLES, 0, pointsCount)\n    }\n    function loaderProgram() {\n      const program = createProgram(\n        gl,\n        [\n          createShader(gl, vertex, gl.VERTEX_SHADER),\n          createShader(gl, frag, gl.FRAGMENT_SHADER)\n        ]\n      )\n      gl.useProgram(program)\n      const vPosition = gl.getAttribLocation(program, 'vPosition')\n      const size = 2 // 定点属性组成数量，必须是 1，2，3 或者 4\n      const type = gl.FLOAT // 数组中每个元素的数据类型\n      const normalized = false // 归一化处理\n      const stride = 0\n      const offset = 0\n      gl.vertexAttribPointer(vPosition, size, type, normalized, stride, offset)\n      gl.enableVertexAttribArray(vPosition)\n    }\n    init()\n    loaderProgram()\n    render()\n  }, [gl])\n  return (\n    <div>\n      <canvas width=\"500px\" height=\"500px\" ref={ref} style={{ backgroundColor: '#fff' }}></canvas>\n    </div>\n  )\n}","import { add, flatten, scale, vec2 } from \"@/common/mv\";\nimport { createProgram, createShader } from \"@/common/shader\";\nimport { useWebGL } from \"@/hooks/useWebGL\";\nimport { useEffect, useRef } from \"react\"\nimport vertex from './shader.vert'\nimport frag from './shader.frag'\n\nexport function Sierpinski() {\n  const ref = useRef<HTMLCanvasElement>(null)\n  const gl = useWebGL(ref)\n  useEffect(() => {\n    if (!gl) {\n      return\n    }\n    const pointsCount = 5000;\n    function init() {\n      const vertices = [\n        vec2(-1.0, -1.0),\n        vec2(0.0, 1.0),\n        vec2(1.0, -1.0)\n      ]\n      const u = scale(0.5, add(vertices[0], vertices[1]))\n      const v = scale(0.5, add(vertices[0], vertices[2]))\n      let p = scale(0.5, add(u, v))\n      const points = [p]\n      for (let i = 1; i <= pointsCount; i++) {\n        const j = Math.floor(Math.random() * 3)\n        p = scale(0.5, add(points[i - 1], vertices[j]))\n        points.push(p)\n      }\n\n      // 创建缓冲区\n      const buffer = gl.createBuffer()\n\n      // gl.ARRAY_BUFFER 表示是顶点数据，现在绑定 buffer 为当前缓冲区\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n\n      // 将数据发送到 GPU 缓存\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(points), gl.STATIC_DRAW)\n    }\n    function render() {\n      gl.clear(gl.COLOR_BUFFER_BIT)\n      gl.drawArrays(gl.POINTS, 0, pointsCount)\n    }\n    function loaderProgram() {\n      const program = createProgram(\n        gl,\n        [\n          createShader(gl, vertex, gl.VERTEX_SHADER),\n          createShader(gl, frag, gl.FRAGMENT_SHADER)\n        ]\n      )\n      gl.useProgram(program)\n      const vPosition = gl.getAttribLocation(program, 'vPosition')\n      const size = 2 // 定点属性组成数量，必须是 1，2，3 或者 4\n      const type = gl.FLOAT // 数组中每个元素的数据类型\n      const normalized = false // 归一化处理\n      const stride = 0\n      const offset = 0\n      gl.vertexAttribPointer(vPosition, size, type, normalized, stride, offset)\n      gl.enableVertexAttribArray(vPosition)\n    }\n    init()\n    loaderProgram()\n    render()\n  }, [gl])\n  return (\n    <div>\n      <canvas width=\"500px\" height=\"500px\" ref={ref} style={{ backgroundColor: '#fff' }}></canvas>\n    </div>\n  )\n}","import { flatten, mix, vec3 } from \"@/common/mv\";\nimport { createProgram, createShader } from \"@/common/shader\";\nimport { useWebGL } from \"@/hooks/useWebGL\";\nimport { useEffect, useRef } from \"react\"\nimport vertex from './shader.vert'\nimport frag from './shader.frag'\n\nexport function Sierpinski() {\n  const ref = useRef<HTMLCanvasElement>(null)\n  const gl = useWebGL(ref)\n  useEffect(() => {\n    if (!gl) {\n      return\n    }\n    const pointsCount = 5000;\n    function init() {\n      const vertices = [\n        vec3(-0.5, -0.5, -0.5),\n        vec3(0.5, -0.5, -0.5),\n        vec3(0.0, 0.5, 0.0),\n        vec3(0.0, -0.5, 0.5)\n      ]\n      const points = [vec3(0.0, 0.0, 0.0)]\n      for (let i = 0; points.length < pointsCount; i++) {\n        const j = Math.floor(Math.random() * 4)\n        points.push(mix(points[i], vertices[j], 0.5))\n      }\n\n      // 创建缓冲区\n      const buffer = gl.createBuffer()\n\n      // gl.ARRAY_BUFFER 表示是顶点数据，现在绑定 buffer 为当前缓冲区\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n\n      // 将数据发送到 GPU 缓存\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(points), gl.STATIC_DRAW)\n    }\n    function render() {\n      gl.clear(gl.COLOR_BUFFER_BIT)\n      gl.drawArrays(gl.POINTS, 0, pointsCount)\n    }\n    function loaderProgram() {\n      const program = createProgram(\n        gl,\n        [\n          createShader(gl, vertex, gl.VERTEX_SHADER),\n          createShader(gl, frag, gl.FRAGMENT_SHADER)\n        ]\n      )\n      gl.useProgram(program)\n      const vPosition = gl.getAttribLocation(program, 'vPosition')\n      const size = 3 // 定点属性组成数量，必须是 1，2，3 或者 4\n      const type = gl.FLOAT // 数组中每个元素的数据类型\n      const normalized = false // 归一化处理\n      const stride = 0\n      const offset = 0\n      gl.vertexAttribPointer(vPosition, size, type, normalized, stride, offset)\n      gl.enableVertexAttribArray(vPosition)\n    }\n    init()\n    loaderProgram()\n    render()\n  }, [gl])\n  return (\n    <div>\n      <canvas width=\"500px\" height=\"500px\" ref={ref} style={{ backgroundColor: '#fff' }}></canvas>\n    </div>  )\n}","import { flatten, mix, vec3 } from \"@/common/mv\";\nimport { createProgram, createShader } from \"@/common/shader\";\nimport { useWebGL } from \"@/hooks/useWebGL\";\nimport { useEffect, useRef } from \"react\"\nimport vertex from './shader.vert'\nimport frag from './shader.frag'\n\nexport function Sierpinski() {\n  const ref = useRef<HTMLCanvasElement>(null)\n  const gl = useWebGL(ref)\n  useEffect(() => {\n    if (!gl) {\n      return\n    }\n    const numTimesDivide = 3\n    const points: number[][] = []\n    const colors: number[][] = []\n    function init() {\n      const vertices = [\n        vec3(0.0000, 0.0000, -1.0000),\n        vec3(0.0000, 0.9428, 0.3333),\n        vec3(-0.8165, -0.4714, 0.3333),\n        vec3(0.8165, -0.4714, 0.3333)\n      ]\n\n      function triangle(a: number[], b: number[], c: number[], color: number) {\n        const baseColor = [\n          vec3(1.0, 0.0, 0.0),\n          vec3(0.0, 1.0, 0.0),\n          vec3(0.0, 0.0, 1.0),\n          vec3(0.0, 0.0, 0.0)\n        ]\n\n        colors.push(baseColor[color])\n        points.push(a)\n        colors.push(baseColor[color])\n        points.push(b)\n        colors.push(baseColor[color])\n        points.push(c)\n      }\n\n      function tetra(a: number[], b: number[], c: number[], d: number[]) {\n        triangle(a, c, b, 0)\n        triangle(a, c, d, 1)\n        triangle(a, b, d, 2)\n        triangle(b, c, d, 3)\n      }\n\n      function divideTriangle(a: number[], b: number[], c: number[], d: number[], count: number) {\n        if (count === 0) {\n          tetra(a, b, c, d)\n        } else {\n          const ab = mix(a, b, 0.5)\n          const ac = mix(a, c, 0.5)\n          const ad = mix(a, d, 0.5)\n          const bc = mix(b, c, 0.5)\n          const bd = mix(b, d, 0.5)\n          const cd = mix(c, d, 0.5)\n\n          count -= 1\n\n          divideTriangle(a, ab, ac, ad, count)\n          divideTriangle(ab, b, bc, bd, count)\n          divideTriangle(ac, bc, c, cd, count)\n          divideTriangle(ad, bd, cd, d, count)\n        }\n      }\n\n      divideTriangle(vertices[0], vertices[1], vertices[2], vertices[3], numTimesDivide)\n\n      gl.enable(gl.DEPTH_TEST)\n    }\n    function render() {\n      gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n      gl.drawArrays(gl.TRIANGLES, 0, points.length)\n    }\n    function loaderProgram() {\n      const program = createProgram(\n        gl,\n        [\n          createShader(gl, vertex, gl.VERTEX_SHADER),\n          createShader(gl, frag, gl.FRAGMENT_SHADER)\n        ]\n      )\n      gl.useProgram(program)\n      const size = 3 // 定点属性组成数量，必须是 1，2，3 或者 4\n      const type = gl.FLOAT // 数组中每个元素的数据类型\n      const normalized = false // 归一化处理\n      const stride = 0\n      const offset = 0\n\n      const cBuffer = gl.createBuffer() // 存储 colors\n      // gl.ARRAY_BUFFER 表示是顶点数据，现在绑定 buffer 为当前缓冲区\n      gl.bindBuffer(gl.ARRAY_BUFFER, cBuffer)\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(colors), gl.STATIC_DRAW)\n\n      const vColor = gl.getAttribLocation(program, 'vColor')\n      gl.vertexAttribPointer(vColor, size, type, normalized, stride, offset)\n      gl.enableVertexAttribArray(vColor)\n\n      // 创建缓冲区\n      const buffer = gl.createBuffer()\n      // 将数据发送到 GPU 缓存\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n      gl.bufferData(gl.ARRAY_BUFFER, flatten(points), gl.STATIC_DRAW)\n\n      const vPosition = gl.getAttribLocation(program, 'vPosition')\n      gl.vertexAttribPointer(vPosition, size, type, normalized, stride, offset)\n      gl.enableVertexAttribArray(vPosition)\n    }\n    init()\n    loaderProgram()\n    render()\n  }, [gl])\n  return (\n    <div>\n      <canvas width=\"500px\" height=\"500px\" ref={ref} style={{ backgroundColor: '#fff' }}></canvas>\n    </div>\n\n  )\n}","interface WEBGLClass {\n  title: string;\n  path: string;\n}\nexport const WEBGLClasses: WEBGLClass[] = [\n  {\n    title: 'demo',\n    path: '/v-world'\n  },\n  {\n    title: 'demo1',\n    path: '/webgl/class1/demo1'\n  },\n  {\n    title: 'demo2',\n    path: '/webgl/class1/demo2'\n  },\n  {\n    title: 'demo3',\n    path: '/webgl/class1/demo3'\n  },\n  {\n    title: 'demo4',\n    path: '/webgl/class1/demo4'\n  },\n]","import { useEffect } from 'react';\nexport enum Mode {\n  DARK,\n  LIGHT\n}\n\nexport function useModeSwitch() {\n  useEffect(() => {\n    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n      document.documentElement.classList.add('dark')\n    } else {\n      document.documentElement.classList.add('light')\n    }\n  }, [])\n}\n\n","import { WEBGLClasses } from \"@/data/webgl-class\";\nimport { Link } from \"react-router-dom\";\n\nimport { Back } from '@components/back'\n\nexport function WEBGLClassesPage() {\n  return (\n    <div className=\"py-4 mx-auto sm:w-screen-sm <sm:px-4\">\n      <h5 className=\"text-lg\">交互式计算机图形学</h5>\n      <p className=\"light:text-gray-500 mt-5\">基于 WebGL 的自顶向下方法（第七版）<br />这有我跟着练习的 demo</p>\n      <ul>\n        {WEBGLClasses.map(cls => (\n          <li key={cls.path}>\n            <Link to={cls.path}>{cls.title}</Link>\n          </li>\n        ))}\n      </ul>\n      <Back />\n    </div>\n  )\n}","import {\n  HashRouter as Router,\n  Switch,\n  Route\n} from 'react-router-dom'\n\nimport App from './App'\nimport { Archive } from './components/archive'\nimport { Article } from './components/article'\nimport { Graffiti } from './components/graffiti'\nimport VWorld from './components/v-world'\nimport { Sierpinski as Class1Demo1 } from './components/webgl/class1/demo1'\nimport { Sierpinski as Class1Demo2 } from './components/webgl/class1/demo2'\nimport { Sierpinski as Class1Demo3 } from './components/webgl/class1/demo3'\nimport { Sierpinski as Class1Demo4 } from './components/webgl/class1/demo4'\nimport { WEBGLClassesPage } from './components/webgl/classes'\nimport { useModeSwitch } from './hooks/useModeSwitch'\n\nexport function RoutesMap() {\n  useModeSwitch()\n  return (\n    <Router>\n      <Switch>\n        <Route exact path=\"/graffiti\" component={Graffiti} />\n        <Route exact path=\"/v-world\" component={VWorld} />\n        <Route exact path=\"/webgl/class1/demo4\" component={Class1Demo4} />\n        <Route exact path=\"/webgl/class1/demo3\" component={Class1Demo3} />\n        <Route exact path=\"/webgl/class1/demo2\" component={Class1Demo2} />\n        <Route exact path=\"/webgl/class1/demo1\" component={Class1Demo1} />\n        <Route exact path=\"/webgl\" component={WEBGLClassesPage} />\n        <Route exact path=\"/articles/:id\" render={props => <Article id={props.match.params.id} {...props} />} />\n        <Route exact path=\"/articles\" component={Archive} />\n        <Route path=\"/\" component={App} />\n      </Switch>\n    </Router>\n  )\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport \"@style/theme.scss\"\nimport 'virtual:windi-base.css'\nimport 'virtual:windi-components.css'\nimport 'virtual:windi-utilities.css'\nimport \"highlight.js/styles/github.css\"\n\nimport { RoutesMap } from './route';\n\nReactDOM.render(\n  <React.StrictMode>\n    <RoutesMap />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}